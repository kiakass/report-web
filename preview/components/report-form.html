<!-- report-form.html -->
<div class="report-container">
  <h1 class="page-title">타겟리포트 생성</h1>
  
  <form id="targetReportForm">
    <!-- 리포트 개요 -->
    <div class="section-card">
      <h2 class="section-title">
        <span class="title-bar"></span>
        리포트 개요
      </h2>
      <div class="form-content">
        <div class="form-group">
          <label class="form-label">리포트명 :</label>
          <div class="form-field">
            <input type="text" class="form-input" id="reportName" name="reportName" placeholder="예: 기업 분석 리포트">
          </div>
        </div>
        <div class="form-group">
          <label class="form-label">활용계획 :</label>
          <div class="form-field">
            <textarea class="form-textarea" id="usagePlan" name="usagePlan" placeholder="예: 영업활동 및 사내계획"></textarea>
          </div>
        </div>
      </div>
    </div>

    <!-- 분석설정 -->
    <div class="section-card">
      <h2 class="section-title">
        <span class="title-bar"></span>
        분석설정
      </h2>
      <div class="form-content">
        <div class="form-group">
          <label class="form-label">기간 :</label>
          <div class="form-field date-range">
            <input type="date" class="form-input date-input" id="startDate" name="startDate">
            <span class="date-separator">~</span>
            <input type="date" class="form-input date-input" id="endDate" name="endDate">
          </div>
        </div>
        
        <div class="form-group">
          <label class="form-label">연령 :</label>
          <div class="form-field age-range">
            <input type="number" class="form-input age-input" id="minAge" name="minAge" value="20" min="20" max="70">
            <span class="age-separator">~</span>
            <input type="number" class="form-input age-input" id="maxAge" name="maxAge" value="50" min="20" max="70">
          </div>
        </div>
        
        <div class="form-group">
          <label class="form-label">대상기업 :</label>
          <div class="form-field company-field">
            <input type="text" class="form-input company-name" id="targetCompanyName" placeholder="기업명입력">
            <input type="text" class="form-input company-url" id="targetCompanyUrl" placeholder="URL 입력">
            <button type="button" class="btn-input" onclick="addTargetCompany()">입력</button>
          </div>
        </div>
        <div class="form-group">
          <label class="form-label"></label>
          <div class="form-field">
            <div class="company-list" id="targetCompanyList">
              <div class="empty-list">하이얼 : www.haier</div>
            </div>
          </div>
        </div>
        
        <div class="form-group">
          <label class="form-label">비교기업 :</label>
          <div class="form-field company-field">
            <input type="text" class="form-input company-name" id="compareCompanyName" placeholder="기업명입력">
            <input type="text" class="form-input company-url" id="compareCompanyUrl" placeholder="URL 입력">
            <button type="button" class="btn-input" onclick="addCompareCompany()">입력</button>
          </div>
        </div>
        <div class="form-group">
          <label class="form-label"></label>
          <div class="form-field">
            <div class="company-list" id="compareCompanyList">
              <div class="empty-list">쿠쿠 : www.kuku.com</div>
            </div>
          </div>
        </div>
        
        <div class="form-group">
          <label class="form-label">추가<br>기업정보 :</label>
          <div class="form-field">
            <div class="additional-info-box">
              <div class="info-dots">○○○○○</div>
              <textarea class="additional-info-textarea" id="additionalInfo" name="additionalInfo" placeholder=""></textarea>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- 분석항목 선택 / 데이터파일 업로드 -->
    <div class="section-card">
      <h2 class="section-title">
        <span class="title-bar"></span>
        분석항목 선택 / 데이터파일 업로드
      </h2>
      <div class="form-content">
        <div class="analysis-grid">
          <div class="analysis-row">
            <input type="checkbox" class="form-checkbox" id="demographics" name="analysisItems" value="demographics">
            <label for="demographics" class="checkbox-label">인구통계학적분석</label>
            <input type="text" class="form-input file-name" id="demographics-file" placeholder="000_base.csv" readonly>
            <label for="demographics-upload" class="btn-search">
              검색
              <input type="file" id="demographics-upload" accept=".csv,.xlsx" onchange="handleFileUpload('demographics', this)" style="display: none;">
            </label>
          </div>
          
          <div class="analysis-row">
            <input type="checkbox" class="form-checkbox" id="timeSeries" name="analysisItems" value="timeSeries">
            <label for="timeSeries" class="checkbox-label">시계열분석</label>
            <input type="text" class="form-input file-name" id="timeSeries-file" placeholder="000_year.csv" readonly>
            <label for="timeSeries-upload" class="btn-search">
              검색
              <input type="file" id="timeSeries-upload" accept=".csv,.xlsx" onchange="handleFileUpload('timeSeries', this)" style="display: none;">
            </label>
          </div>
          
          <div class="analysis-row">
            <input type="checkbox" class="form-checkbox" id="visitedSites" name="analysisItems" value="visitedSites">
            <label for="visitedSites" class="checkbox-label">주요방문사이트</label>
            <input type="text" class="form-input file-name" id="visitedSites-file" placeholder="000_site.csv" readonly>
            <label for="visitedSites-upload" class="btn-search">
              검색
              <input type="file" id="visitedSites-upload" accept=".csv,.xlsx" onchange="handleFileUpload('visitedSites', this)" style="display: none;">
            </label>
          </div>
          
          <div class="analysis-row">
            <input type="checkbox" class="form-checkbox" id="crossVisit" name="analysisItems" value="crossVisit">
            <label for="crossVisit" class="checkbox-label">교차방문율</label>
            <input type="text" class="form-input file-name" id="crossVisit-file" placeholder="000_crossvisit.csv" readonly>
            <label for="crossVisit-upload" class="btn-search">
              검색
              <input type="file" id="crossVisit-upload" accept=".csv,.xlsx" onchange="handleFileUpload('crossVisit', this)" style="display: none;">
            </label>
          </div>
        </div>
      </div>
    </div>

    <div class="submit-container">
      <button type="submit" class="btn-submit">리포트 만들기</button>
    </div>
  </form>
</div>

<style>
/* 전체 컨테이너 */
.report-container {
  max-width: 900px;
  margin: 0 auto;
  padding: 20px;
  background: #f5f5f5;
  min-height: 100vh;
}

.page-title {
  font-size: 24px;
  font-weight: bold;
  margin-bottom: 30px;
  color: #333;
}

/* 섹션 카드 */
.section-card {
  background: white;
  border-radius: 8px;
  margin-bottom: 20px;
  box-shadow: 0 1px 3px rgba(0,0,0,0.1);
  overflow: hidden;
}

.section-title {
  display: flex;
  align-items: center;
  gap: 10px;
  font-size: 16px;
  font-weight: bold;
  color: #333;
  background: #f8f9fa;
  padding: 15px 20px;
  margin: 0;
  border-bottom: 1px solid #e9ecef;
}

.title-bar {
  width: 4px;
  height: 20px;
  background: #0066cc;
  border-radius: 2px;
}

.form-content {
  padding: 20px;
}

/* 폼 그룹 */
.form-group {
  display: flex;
  margin-bottom: 20px;
  align-items: flex-start;
}

.form-label {
  width: 120px;
  padding-top: 8px;
  font-size: 14px;
  color: #555;
  text-align: right;
  padding-right: 15px;
  flex-shrink: 0;
}

.form-field {
  flex: 1;
}

/* 입력 필드 */
.form-input {
  width: 100%;
  padding: 8px 12px;
  border: 1px solid #ddd;
  border-radius: 4px;
  font-size: 14px;
  transition: border-color 0.3s;
}

.form-input:focus {
  outline: none;
  border-color: #4CAF50;
}

.form-textarea {
  width: 100%;
  min-height: 80px;
  padding: 8px 12px;
  border: 1px solid #ddd;
  border-radius: 4px;
  font-size: 14px;
  resize: vertical;
}

/* 날짜 및 연령 입력 */
.date-range, .age-range {
  display: flex;
  align-items: center;
  gap: 10px;
}

.date-input {
  width: 140px;
}

.age-input {
  width: 80px;
}

.date-separator, .age-separator {
  color: #999;
}

/* 기업 입력 */
.company-field {
  display: flex;
  gap: 10px;
}

.company-name, .company-url {
  flex: 1;
}

.btn-input {
  padding: 8px 24px;
  background: #6c757d;
  color: white;
  border: none;
  border-radius: 4px;
  font-size: 14px;
  cursor: pointer;
  white-space: nowrap;
}

.btn-input:hover {
  background: #5a6268;
}

/* 기업 리스트 */
.company-list {
  background: #f8f9fa;
  border: 1px solid #dee2e6;
  border-radius: 4px;
  min-height: 100px;
  padding: 12px;
}

.empty-list {
  color: #6c757d;
  font-size: 14px;
}

.company-item {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 8px 0;
  font-size: 14px;
}

.delete-button {
  color: #dc3545;
  background: none;
  border: none;
  cursor: pointer;
  font-size: 14px;
  padding: 4px 12px;
}

.delete-button:hover {
  background: #ffe5e5;
  border-radius: 3px;
}

/* 추가 기업정보 */
.additional-info-box {
  background: #f8f0ff;
  border: 1px solid #e0d0ff;
  border-radius: 4px;
  padding: 15px;
  position: relative;
}

.info-dots {
  color: #9b7fb8;
  font-size: 14px;
  margin-bottom: 10px;
}

.additional-info-textarea {
  width: 100%;
  min-height: 100px;
  background: transparent;
  border: none;
  font-size: 14px;
  line-height: 1.8;
  resize: vertical;
  outline: none;
}

/* 분석항목 그리드 */
.analysis-grid {
  display: flex;
  flex-direction: column;
  gap: 15px;
}

.analysis-row {
  display: flex;
  align-items: center;
  gap: 15px;
}

.form-checkbox {
  width: 18px;
  height: 18px;
  cursor: pointer;
}

.checkbox-label {
  width: 140px;
  font-size: 14px;
  cursor: pointer;
}

.file-name {
  flex: 1;
  background: #f8f9fa;
}

.btn-search {
  padding: 8px 24px;
  background: #6c757d;
  color: white;
  border-radius: 4px;
  font-size: 14px;
  cursor: pointer;
  display: inline-block;
}

.btn-search:hover {
  background: #5a6268;
}

/* 제출 버튼 */
.submit-container {
  display: flex;
  justify-content: flex-end;
  margin-top: 30px;
}

.btn-submit {
  padding: 12px 40px;
  background: #6c757d;
  color: white;
  border: none;
  border-radius: 4px;
  font-size: 16px;
  cursor: pointer;
}

.btn-submit:hover {
  background: #5a6268;
}
</style>

<script>
// 대상기업 리스트
let targetCompanyList = [];
let compareCompanyList = [];

// 날짜 설정
window.addEventListener('DOMContentLoaded', function() {
  const today = new Date();
  const oneYearAgo = new Date();
  oneYearAgo.setFullYear(oneYearAgo.getFullYear() - 1);
  
  document.getElementById('startDate').min = oneYearAgo.toISOString().split('T')[0];
  document.getElementById('startDate').max = today.toISOString().split('T')[0];
  document.getElementById('endDate').min = oneYearAgo.toISOString().split('T')[0];
  document.getElementById('endDate').max = today.toISOString().split('T')[0];
});

// 대상기업 추가
function addTargetCompany() {
  const name = document.getElementById('targetCompanyName').value;
  const url = document.getElementById('targetCompanyUrl').value;
  
  if (name && url && targetCompanyList.length < 1) {
    targetCompanyList.push({name, url});
    updateTargetCompanyList();
    document.getElementById('targetCompanyName').value = '';
    document.getElementById('targetCompanyUrl').value = '';
  }
}

// 대상기업 리스트 업데이트
function updateTargetCompanyList() {
  const listEl = document.getElementById('targetCompanyList');
  if (targetCompanyList.length === 0) {
    listEl.innerHTML = '<div class="empty-list">하이얼 : www.haier</div>';
  } else {
    listEl.innerHTML = targetCompanyList.map((company, index) => `
      <div class="company-item">
        <span>${company.name} : ${company.url}</span>
        <button type="button" class="delete-button" onclick="removeTargetCompany(${index})">삭제</button>
      </div>
    `).join('');
  }
}

// 대상기업 삭제
function removeTargetCompany(index) {
  targetCompanyList = [];
  updateTargetCompanyList();
}

// 비교기업 추가
function addCompareCompany() {
  const name = document.getElementById('compareCompanyName').value;
  const url = document.getElementById('compareCompanyUrl').value;
  
  if (name && url && compareCompanyList.length < 10) {
    compareCompanyList.push({name, url});
    updateCompareCompanyList();
    document.getElementById('compareCompanyName').value = '';
    document.getElementById('compareCompanyUrl').value = '';
  }
}

// 비교기업 리스트 업데이트
function updateCompareCompanyList() {
  const listEl = document.getElementById('compareCompanyList');
  if (compareCompanyList.length === 0) {
    listEl.innerHTML = '<div class="empty-list">쿠쿠 : www.kuku.com</div>';
  } else {
    listEl.innerHTML = compareCompanyList.map((company, index) => `
      <div class="company-item">
        <span>${company.name} : ${company.url}</span>
        <button type="button" class="delete-button" onclick="removeCompareCompany(${index})">삭제</button>
      </div>
    `).join('');
  }
}

// 비교기업 삭제
function removeCompareCompany(index) {
  compareCompanyList.splice(index, 1);
  updateCompareCompanyList();
}

// 파일 업로드 처리
function handleFileUpload(type, input) {
  const file = input.files[0];
  if (file && (file.name.endsWith('.csv') || file.name.endsWith('.xlsx'))) {
    document.getElementById(type + '-file').value = file.name;
  }
}

// 폼 제출 처리
document.getElementById('targetReportForm').addEventListener('submit', function(e) {
  e.preventDefault();
  
  // 폼 데이터 수집
  const formData = {
    reportName: document.getElementById('reportName').value,
    usagePlan: document.getElementById('usagePlan').value,
    startDate: document.getElementById('startDate').value,
    endDate: document.getElementById('endDate').value,
    minAge: document.getElementById('minAge').value,
    maxAge: document.getElementById('maxAge').value,
    targetCompany: targetCompanyList,
    compareCompanies: compareCompanyList,
    additionalInfo: document.getElementById('additionalInfo').value,
    analysisItems: {
      demographics: document.getElementById('demographics').checked,
      timeSeries: document.getElementById('timeSeries').checked,
      visitedSites: document.getElementById('visitedSites').checked,
      crossVisit: document.getElementById('crossVisit').checked
    },
    uploadedFiles: {
      demographics: document.getElementById('demographics-file').value,
      timeSeries: document.getElementById('timeSeries-file').value,
      visitedSites: document.getElementById('visitedSites-file').value,
      crossVisit: document.getElementById('crossVisit-file').value
    }
  };
  
  console.log('리포트 생성 데이터:', formData);
  alert('리포트 생성이 완료되었습니다!');
});
</script>